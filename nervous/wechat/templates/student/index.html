{% extends 'base.html' %}

{% block title %}清华大学微信公众号备案平台{% endblock title %}

{% block subtitle %}{% endblock subtitle %}

{% block left-column %}

    <a style="text-decoration: none;" href="#" data-toggle="collapse" data-target="#application-menu"><strong><i
            class="glyphicon glyphicon-wrench"></i>　管理公众号申请</strong></a>
    <hr>
    <ul class="nav nav-stacked collapse in" id="application-menu">
        <ul class="nav nav-stacked collapse in" id="userMenu">
            <li class="nav-header"><a href="#"><i class="glyphicon glyphicon-plus-sign"></i>　添加备案申请</a></li>
            <li class="nav-header"><a href="#"><i class="glyphicon glyphicon-briefcase"></i>　我的备案申请 <span
                    class="badge badge-info">{{ pending_count }}</span></a></li>
        </ul>
        </li>
    </ul>
{% endblock left-column %}

{% block main-page %}
    <a style="text-decoration: none;" href="#"><strong><i class="glyphicon glyphicon-dashboard"></i>　信息总览</strong></a>
    <hr>
    <div class="row">
        <!-- center left-->
        <div class="col-md-12">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h4>我的备案申请<span class="badge pull-right">{{ pending_count }}</span></h4></div>
                <div class="panel-body">
                    <div class="table-responsive">
                        <table class="table table-striped">
                            <thead>
                            <tr>
                                <th>公众号名称</th>
                                <th>公众号简介</th>
                                <th>审批状态</th>
                                <th>处理人</th>
                            </tr>
                            </thead>
                            <tbody>
                            {% for app in applications %}
                                <tr>
                                    <td>{{ app.name }}</td>
                                    <td>{{ app.description|linebreaksbr }}</td>
                                    <td>
                                        <span class="glyphicon {{ app.status_glyphicon }}"></span> {{ app.status_name }}
                                    </td>
                                    <td>{{ app.operator_admin }}</td>
                                </tr>
                            {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h4>添加备案申请</h4></div>
                <div class="panel-body">
                    <form id="application_form" class="form form-vertical">
                        {% csrf_token %}
                        <div class="control-group">
                            <label>公众号名称</label>

                            <div class="controls">
                                <input name="name" type="text" class="form-control" placeholder="公众号名称">
                            </div>
                        </div>
                        <div class="control-group">
                            <label>公众号简介</label>

                            <div class="controls">
                                            <textarea name="description" class="form-control"
                                                      placeholder="公众号简介"></textarea>
                            </div>
                        </div>
                        <div class="control-group">
                            <label>所属学生组织</label>

                            <div class="controls">
                                <select name="association" class="form-control">
                                    <option value="校学生会">校学生会</option>
                                    <option value="校科协">校科协</option>
                                    <option value="校团委">校团委</option>
                                    <option value="计算机系学生会">计算机系学生会</option>
                                </select>
                            </div>
                        </div>
                        <div class="control-group">
                            <div class="row">
                                <div class="col-sm-6">
                                    <label>负责人姓名</label>

                                    <div class="controls">
                                        <input name="manager_name" type="text" class="form-control"
                                               placeholder="负责人姓名">
                                    </div>
                                </div>
                                <div class="col-sm-6">
                                    <label>负责人学号</label>

                                    <div class="controls">
                                        <input name="manager_student_id" type="text" class="form-control"
                                               placeholder="负责人学号">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="control-group">
                            <div class="row">
                                <div class="col-sm-6">
                                    <label>负责人电话</label>

                                    <div class="controls">
                                        <input name="manager_tel" type="text" class="form-control"
                                               placeholder="负责人电话">
                                    </div>
                                </div>
                                <div class="col-sm-6">
                                    <label>负责人邮箱</label>

                                    <div class="controls">
                                        <input name="manager_email" type="email" class="form-control"
                                               placeholder="负责人邮箱">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="control-group">
                            <label>负责人院系</label>

                            <div class="controls">
                                <select name="manager_dept" class="form-control">
                                    <option value="计算机系">计算机系</option>
                                    <option value="人文学院">人文学院</option>
                                    <option value="隔壁">隔壁</option>
                                </select>
                            </div>
                        </div>
                        <div class="control-group">
                            <label></label>

                            <div class="controls">
                                <button type="submit" name="method" value="submit" class="btn btn-primary">
                                    提交
                                </button>
                                <button type="submit" name="method" value="save" class="btn btn-default">
                                    保存
                                </button>
                            </div>
                        </div>
                    </form>
                    <script>
                        $("#application_form").submit(function (event) {
                            event.preventDefault();
                            var url = "{% url 'submit_application' %}";
                            $.ajax({
                                type: "POST",
                                url: url,
                                data: $("#application_form").serialize(),
                                success: function (data) {
                                    location.reload();
                                }
                            });
                        });
                    </script>
                </div>
            </div>
        </div>
        <!--/col-->
    </div>
    <!--/row-->
    <hr>
    <a style="text-decoration: none;" href="#"><strong><i class="glyphicon glyphicon-comment"></i>　管理员消息</strong></a>
    <hr>
    <div class="row">
        <div class="col-md-12">
            <ul class="list-group">
                <li class="list-group-item"><a href="#"><i class="glyphicon glyphicon-flash"></i>
                    <small>(3 mins ago)</small>
                    The 3rd page reports don't contain any links. Does anyone know why..</a></li>
                <li class="list-group-item"><a href="#"><i class="glyphicon glyphicon-flash"></i>
                    <small>(1 hour ago)</small>
                    Hi all, I've just post a report that show the relationship betwe..</a></li>
                <li class="list-group-item"><a href="#"><i class="glyphicon glyphicon-heart"></i>
                    <small>(2 hrs ago)</small>
                    Paul. That document you posted yesterday doesn't seem to contain the over..</a></li>
                <li class="list-group-item"><a href="#"><i class="glyphicon glyphicon-heart-empty"></i>
                    <small>(4 hrs ago)</small>
                    The map service on c243 is down today. I will be fixing the..</a></li>
                <li class="list-group-item"><a href="#"><i class="glyphicon glyphicon-heart"></i>
                    <small>(yesterday)</small>
                    I posted a new document that shows how to install the services layer..</a></li>
                <li class="list-group-item"><a href="#"><i class="glyphicon glyphicon-flash"></i>
                    <small>(yesterday)</small>
                    ..</a></li>
            </ul>
        </div>
    </div>
{% endblock main-page %}
